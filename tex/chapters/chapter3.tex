
\cleardoublepage


\chapter{Finite Volume Method of 1D Time Dependent Heat Equation}

\section{Governing Equation}
An one-dimensional nonlinear time dependent heat equation is defined as:
\begin{equation}
\frac{\partial u}{\partial t} = \alpha(x,u) \frac{\partial^2 u}{\partial x^2} + S(x,t)
\end{equation}
where thermal diffusivity $\alpha$ is linearly dependent on density ($\rho$), heat capacity(C), and thermal conductivity ($\kappa$) by:
\begin{equation}
\alpha(x,u) = \frac{\kappa(x,u)}{\rho C}
\end{equation}
with initial condition condition:
\begin{equation}
k(0,x) = f(x) 
\end{equation}
This equation could be combined with arbitrary boundary condition, etc, Dirichlet boundary condition, Neumann boundary condition, or Mixed boundary condition. The specific details will be talked in the following section.

\section{Discretization}
To solve heat equation numerically, we will discrete the heat equation by a mesh-centered, finite-volume approach. By integrating the governing equation over cell j:
\begin{equation}
\int^{x_{j+1/2}}_{x_{j+1/2}} \frac{\partial u}{\partial t} dx =  \int^{x_{j+1/2}}_{x_{j+1/2}} \alpha(x,u) \frac{\partial^2 u}{\partial x^2} dx + \int^{x_{j+1/2}}_{x_{j+1/2}} s(x,t) dx
\end{equation}
or
\begin{equation}
\Delta x_j u_t = \alpha_j [ u_x(x_{j+1/2})- u_x(x_{j-1/2}) ] + \Delta x_j S_j
\end{equation}

Here we can employ mesh center approximation to compute mesh center value by the mesh boundary value, which could be written as following:
\begin{equation}
u_j(t) \approx \frac{1}{h} \int^{x_{j+1/2}}_{x_{j+1/2}} u(t,x) dx
\end{equation}

We define heat flux at cell boundary as $\phi$. In order to keep the continuity of the heat flux:
\begin{equation}
\alpha_{j-1}\phi^+(x_{j-1/2}) =  \alpha_{j}\phi^-(x_{j-1/2})
\end{equation}	
where $+$ infers to the flux goes from left to right, therefore, $-$ infers to the flux goes from  right to left.
To evaluate the heat flux, we employ Taylor expansions. For a left boundary of cell j:
\begin{equation}
u(x_{j-1}) \approx u(x_{j-1/2}) - \frac{\Delta x_{j-1}}{2} \phi^{+}(x_{j-1/2})
\end{equation} 
and 
\begin{equation}
u(x_{j}) \approx u(x_{j-1/2}) + \frac{\Delta x_{j-1}}{2} \phi^{-}(x_{j-1/2})
\end{equation} 
From the three equations, we find:
\begin{equation}
\phi(x_{j-1/2}) = 2 \alpha_{j-1}(\frac{u_j-u_{j-1}}{\Delta x_j \alpha_{j-1} + \Delta x_{j-1} \alpha_{j} })
\end{equation}
and similarly,
\begin{equation}
\phi(x_{j+1/2}) = 2 \alpha_{j+1}(\frac{u_{j+1}-u_{j}}{\Delta x_{j} \alpha_{j+1} + \Delta x_{j+1} \alpha_{j} })
\end{equation}
Before we substitute of above equations into equation 3.5, we can define notations as:
\begin{equation}
\tilde{\alpha}_{j+1/2} = \frac{2 \alpha_{j+1}\alpha_{j}}{\Delta x_{j} \alpha_{j+1} + \Delta x_{j+1} \alpha_{j} }
\end{equation}
and
\begin{equation}
\tilde{\alpha}_{j-1/2} = \frac{2 \alpha_{j-1}\alpha_{j}}{\Delta x_j \alpha_{j-1} + \Delta x_{j-1} \alpha_{j} }
\end{equation}
Then equation 10.3 become:
\begin{equation}
\Delta x_j u_t = \frac{\tilde{\alpha}_{j+1/2} }{\Delta i}(u_{j+1}-u_{j}) - \frac{\tilde{\alpha}_{j-1/2} }{\Delta i} (u_{j}-u_{j-1}) +S_j
\end{equation}
