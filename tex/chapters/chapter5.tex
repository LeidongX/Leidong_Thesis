\cleardoublepage

\chapter{The DMD-FPM(n) Method}
\label{chapter:DMD-FPM(n)}

As mentioned in \CHAPTER{chapter:PM}, the flattened power method is a more efficient approach for solving multigroup neutron transport equation.
And we have discussed a restarted, DMD-accelerated power method scheme in last chapter, which suggest us there is penitential to develop this algorithm to fit the flattened power method.
This chapter contains a complete description of an accelerated flattened power method using DMD, which has been summarized in a transaction by the author of this thesis \cite{xu_acceleration}. 

\section{Methodology}
The basic framework of DMD-FPM($n$) is similar to DMD-PM($n$), which the main difference is the snapshots now are generated by the flattened power method.
In short, a set of flattened power iterations are performed, then, the snapshots are used for DMD to correct the dominant mode and eigenvalue, which is used to continue power iterations.
The process can be repeated until the results converge, which leads to a {\it restarted} DMD-FPM (or DMD-FPM($n$)).

\subsection{Aitken Extrapolation}
Note that not only the eigenvector is required at every restarting point, but also the corresponding eigenvalue.
The updated eigenvalue in DMD-PM($n$) algorithm is equal to the norm of the DMD predicted eigenmodes. 
One significant drawback of the flattened power method is that we cannot compute the corresponding eigenvalue by the DMD response, because the eigenvalue has been already applied on the snapshots of neutron flux.
In other words, there is no easy way to find the eigenvalue $k$ associated with the predicted $\mathbf{x}$, which is projected forward in ``time".
Therefore, there would be a inherent mismatch between the accelerated dominant eigenvector and its eigenvalue.

Many mathematical approaches were tested to extrapolate a eigenvalue to match the DMD eigenvector. 
A first attempt used the last computed eigenvalue, i.e., an eigenvalue that may be the equivalent of tens or hundreds of flattened power iterations in the ``past."
However, the error caused by that choice of eigenvalue tended to reduce the improvement of the DMD extrapolation significantly, which erase all the improvement from DMD sometimes.
Another attempt is insert the eigenvalue as the first element in the snapshot, which does not work neither.
And the reason might be that we modified the standard DMD algorithm and only dominant modes is used.
Some other failures include linear and polynomial extrapolation. 
In order to predict a more appropriate eigenvalue, Aitken extrapolation was employed \cite{aitken_1927} as
\begin{equation}
k_{aitken} = k_{i-2} - \frac{(k_{i-1}-k_{i-2})^2}{(k_i - 2k_{i-1} + k_{i-2})}\, ,
\end{equation}
where $k_i$ is the eigenvalue from the ith iteration of the flattened power iteration.
Although Aitken extrapolation does not eliminate the error from eigenvector/eigenvalue mismatch completely, significant improvement in numerical tests were observed.

The procedure for applying DMD to the flattened power iteration with Aitken extrapolation is summarized as follows.

\begin{enumerate}
 \item Assume $k_{(0)}$, $\mathbf{x}_{(0)}$ and normalize.
 \item Perform $n$ flattened operator applications (\EQ{eq:flatten}) to produce $\mathbf{X}_0$ and $\mathbf{X}_1$.
 \item Compute the DMD modes and frequencies using a rank-$r$, truncated  SVD (i.e., $r < n$).
 \item Apply equation $\mathbf{x}_{0}=\frac{b_0 \vec{\phi}^{}_0}{ ||b_0 \vec{\phi}^{}_0||}$ to estimate $\mathbf{x}^{(\infty)}=\mathbf{x}(\infty)$, i.e., estimate the steady-state, dominant mode after an equivalent of $\infty$ power iterations.
 \item Update $k_{(0)}$ by Aitken extrapolation.
 \item Repeat Steps 1 through 5 until converged.
\end{enumerate}

Both DMD-PM($n$) and DMD-FPM($n$) are tested to verify the performance to accelerate solving neutron transport/diffusion problem. The testing cases and numerical analysis are presented in the following chapter. 


